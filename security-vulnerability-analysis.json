{
  "analysis_date": "2025-08-25T16:40:56.014789",
  "total_alerts": 679,
  "summary": {
    "severity_breakdown": {
      "high": 29,
      "note": 611,
      "warning": 27,
      "medium": 12
    },
    "top_vulnerability_types": {
      "js/unused-local-variable": 586,
      "js/syntax-error": 22,
      "js/useless-assignment-to-local": 14,
      "js/incomplete-multi-character-sanitization": 13,
      "js/trivial-conditional": 8,
      "js/xss-through-dom": 4,
      "js/unreachable-statement": 4,
      "js/bad-tag-filter": 4,
      "js/double-escaping": 3,
      "js/automatic-semicolon-insertion": 3,
      "js/file-system-race": 3,
      "js/stack-trace-exposure": 3,
      "js/incomplete-url-substring-sanitization": 2,
      "js/incomplete-url-scheme-check": 2,
      "js/incomplete-sanitization": 1
    },
    "most_vulnerable_files": {
      "src/pages/Profile.tsx": 36,
      "src/pages/Dashboard.broken.tsx": 27,
      "schema_check.ts": 22,
      "src/components/admin/EnhancedPermissionManager.tsx": 19,
      "src/components/admin-settings/EmailSettings.tsx": 17,
      "src/pages/AdminSettings.tsx": 16,
      "src/pages/Dashboard.tsx": 14,
      "src/pages/Dashboard.restored.tsx": 13,
      "src/pages/Dashboard-Original.tsx": 13,
      "src/pages/AdminMembership.tsx": 11,
      "src/pages/EditUserEnhanced.tsx": 11,
      "src/pages/Directory.tsx": 10,
      "src/pages/AdminDashboard.tsx": 10,
      "src/components/EmailTemplateManager.tsx": 10,
      "src/pages/AdminUsers.tsx": 9
    }
  },
  "priority_ranking": {
    "immediate_action": [
      {
        "priority": 1,
        "category": "Active XSS vulnerabilities",
        "count": 4,
        "description": "Cross-site scripting vulnerabilities that need immediate attention",
        "files": [
          "src/components/admin-settings/EmailTemplateEditor.tsx:518",
          "src/components/EventForm/sections/ImageSection.tsx:631",
          "src/components/EventForm/sections/ImageSection.tsx:613", 
          "src/components/AdImageUpload.tsx:122"
        ]
      },
      {
        "priority": 2,
        "category": "High severity sanitization issues not covered by recent fix",
        "count": 16,
        "description": "HTML sanitization issues in files other than email services",
        "files": [
          "src/utils/input-validation.ts",
          "src/utils/htmlSanitizer.ts", 
          "src/middleware/security-validation.ts",
          "src/pages/AdManagement.tsx",
          "src/components/AdDisplay.tsx"
        ]
      },
      {
        "priority": 3,
        "category": "Potentially already fixed email service vulnerabilities",
        "count": 6,
        "description": "These may already be resolved by commit 1642a31",
        "action": "Verify and dismiss if fixed"
      }
    ],
    "should_review": [
      {
        "priority": 4,
        "category": "File system race conditions",
        "count": 3,
        "description": "Potential race conditions in scripts"
      },
      {
        "priority": 5,
        "category": "Insecure randomness", 
        "count": 1,
        "description": "Cryptographically insecure random number usage"
      }
    ],
    "cleanup_tasks": [
      {
        "priority": 6,
        "category": "False positives in test/backup files",
        "count": 608,
        "description": "Alerts in Dashboard.broken.tsx, schema_check.ts, and other non-production files"
      }
    ]
  },
  "key_findings": {
    "critical_security_issues": 20,
    "potentially_fixed_by_recent_commit": 6,
    "false_positives_estimated": 608,
    "real_issues_requiring_attention": 65
  },
  "recommendations": {
    "immediate": [
      "Fix XSS vulnerabilities in EmailTemplateEditor, ImageSection, and AdImageUpload components",
      "Review HTML sanitization in htmlSanitizer.ts, input-validation.ts, and security-validation.ts",
      "Verify that email service vulnerabilities are resolved and dismiss those alerts",
      "Fix URL sanitization issues in AdManagement and AdDisplay components"
    ],
    "short_term": [
      "Replace Math.random() with crypto.getRandomValues() in EventDetails.tsx",
      "Fix file system race conditions in security scripts", 
      "Clean up unused variables in main source files (not test/backup files)",
      "Review indirect command injection in bump-version.js"
    ],
    "long_term": [
      "Implement comprehensive security scanning exclusions for test/backup files",
      "Consider using established sanitization libraries (DOMPurify) consistently",
      "Regular security code review process for all user input handling",
      "Add security-focused unit tests for sanitization functions"
    ]
  }
}